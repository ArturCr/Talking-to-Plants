This code verssion works but requires renaming and cleaning up